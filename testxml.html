<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" >
 <head>
  <script language="javascript" type="text/javascript">

var url = "http://helpdesk.ccboe.com/helpdesk-test/getoldinvpage.pl";
var working_on_it = false;
var result_field = '';
var page_field = '';

function getHTTPObject() {
	var xmlhttp;
	/*@cc_on
	@if (@_jscript_version >= 5)
		try {
			xmlhttp = new ActiveXObject("Msxml2.XMLHTTP");
		} catch (e) {
			try {
				xmlhttp = new ActiveXObject("Microsoft.XMLHTTP");
			} catch (E) {
				xmlhttp = false;
			}
		}
	@else
		xmlhttp = false;
	@end @*/
	if (!xmlhttp && typeof XMLHttpRequest != 'undefined') {
		try {
			xmlhttp = new XMLHttpRequest();
		} catch (e) {
			xmlhttp = false;
		}
	}
	return xmlhttp;
}

function handleHttpResponse_as_XML() {
	if (http.readyState == 4) {
		var xobj = http.responseXML;
		if(http.responseXML){
			var ar = xobj.getElementsByTagName('field');

//			for(var i=0;i<ar.length;i++){
//				alert(ar.item(i).firstChild.data);
//			}
//			var v = xobj.getElementsByTagName('field').item(0).childNodes[0].data;
			var v = xobj.getElementsByTagName('field').item(0).childNodes[0].data;
/*			var v = xobj.getElementsByTagName('stuff').item(0).firstChild.data;
//			alert(xobj.getElementsByTagName('stuff').item(0));*/
			if(v){
					document.getElementById(page_field).value = v;
//					document.getElementById(page_field).innerHTML = v;
// it works but how do I differentiate between an input field needing .value and a div?
			}
		}
		working_on_it = false;
	}
}

function fetch_it(url,from,into) {
	result_field = from;
	page_field = into;
	if(! working_on_it && http){
		http.open("GET", url, true);
		http.onreadystatechange = handleHttpResponse_as_XML;
		working_on_it = true;
		http.send(null);
	}
}


var http = getHTTPObject();

  </script>
  <title> test </title>
 </head>
 <body>
  <form action="post">
   For barcode: <input type="text" name="barcode" id="barcode" value="8990" />
   Get field: <input type="text" name="key" id="key" value="mac_address" />
   <input type="button" id="baz" onclick="fetch_it(url + '?field=' + document.getElementById('key').value + '&barcode=' + document.getElementById('barcode').value,document.getElementById('key').value,'output');" value="Get it" />
   <input type="button" id="baz" onclick="fetch_it(url + '?field=' + document.getElementById('key').value + '&barcode=' + document.getElementById('barcode').value,document.getElementById('key').value,'hmm');" value="Get it" />
  </form>

  Got: <input id="output" type="text" value="" />
  Got2: <div id="hmm"></div>
 </body>
</html>
